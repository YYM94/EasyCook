<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="RecipeBoard">
 
	<insert id="ins_rb" parameterType="rb" keyProperty="no">
		insert into recipeBoard 
		(no, writerid, title, videoLink, imgIndex, imgFolder, textPack, regdate, moddate)
		values
		(rb_seq.nextval, #{writerid}, #{title}, #{videoLink}, #{imgIndex}, CONCAT(#{imgFolder}, TO_CHAR(rb_seq.currval)), #{textPack}, sysdate, sysdate)
		<selectKey keyProperty="no" resultType="integer" order="AFTER">
			select rb_seq.currval from dual
		</selectKey>
	</insert>
	
	<select id="get_total" resultType="int">
		select count(*) from recipeBoard
	</select>
	
	<select id="get_rb_list" resultType="rb">
		select * from
			(select rowNum rNum, no, writerid, title, videoLink, imgIndex, imgFolder, textPack, visiter, regdate, moddate 
			from 
				(select * from RECIPEBOARD order by no desc))
		where rNum &gt;= #{startNum} and rNum &lt;= #{endNum}
	</select>
 
</mapper>